# frozen_string_literal: true

require "spec_helper"

describe TimexDatalinkClient::WristApp do
  let(:wrist_app_data) { File.open("spec/fixtures/EXAMPLE.ZAP", "rb").read }
  let(:wrist_app) { described_class.new(wrist_app_data: wrist_app_data) }

  describe "#packets", :crc do
    subject(:packets) { wrist_app.packets }

    it_behaves_like "CRC-wrapped packets", [
      [0x93, 0x02],
      [0x90, 0x02, 0x04, 0x01],
      [
        0x91, 0x02, 0x01, 0x4c, 0x6f, 0x72, 0x65, 0x6d, 0x20, 0x69, 0x70, 0x73, 0x75, 0x6d, 0x20, 0x64, 0x6f, 0x6c,
        0x6f, 0x72, 0x20, 0x73, 0x69, 0x74, 0x20, 0x61, 0x6d, 0x65, 0x74, 0x2c, 0x20, 0x63, 0x6f, 0x6e, 0x73
      ],
      [
        0x91, 0x02, 0x02, 0x65, 0x63, 0x74, 0x65, 0x74, 0x75, 0x72, 0x20, 0x61, 0x64, 0x69, 0x70, 0x69, 0x73, 0x63,
        0x69, 0x6e, 0x67, 0x20, 0x65, 0x6c, 0x69, 0x74, 0x2c, 0x20, 0x73, 0x65, 0x64, 0x20, 0x64, 0x6f, 0x20
      ],
      [
        0x91, 0x02, 0x03, 0x65, 0x69, 0x75, 0x73, 0x6d, 0x6f, 0x64, 0x20, 0x74, 0x65, 0x6d, 0x70, 0x6f, 0x72, 0x20,
        0x69, 0x6e, 0x63, 0x69, 0x64, 0x69, 0x64, 0x75, 0x6e, 0x74, 0x20, 0x75, 0x74, 0x20, 0x6c, 0x61, 0x62
      ],
      [
        0x91, 0x02, 0x04, 0x6f, 0x72, 0x65, 0x20, 0x65, 0x74, 0x20, 0x64, 0x6f, 0x6c, 0x6f, 0x72, 0x65, 0x20, 0x6d,
        0x61, 0x67, 0x6e, 0x61, 0x20, 0x61, 0x6c, 0x69, 0x71, 0x75, 0x61, 0x2e
      ],
      [0x92, 0x02]
    ]
  end
end

